// @ts-check
import Check from "../../../assets/Check.js";
import { world } from "@minecraft/server";

class NamespoofB extends Check {
	/**
	 * @class
	 * @description Check for invalid characters in a player's name
	 */
	constructor() {
		super();

		this.check = "Namespoof";
		this.subcheck = "B";
		this.type = "Exploit";

		if(this.config.enabled) this.enable();
	}

	enable() {
		world.afterEvents.playerSpawn.subscribe((...args) => this.afterPlayerSpawn(...args));
	}

	disable() {
		world.afterEvents.playerSpawn.unsubscribe(this.afterPlayerSpawn);
	}

	/**
	 * @param {import("@minecraft/server").PlayerSpawnAfterEvent} data
	 */
	afterPlayerSpawn(data) {
		const { initialSpawn, player } = data;
		if(!initialSpawn) return;

		if(RegExp(this.config.regex).test(player.name)) {
			this.flag(player);
		}
	}
}

export default new NamespoofB();